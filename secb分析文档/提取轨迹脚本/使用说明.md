# 如何使用这些材料进行轨迹分析

## 📦 提供的材料

### 1. 分析提示词
**文件**: `secb分析文档/分析提示词_轨迹分析.md`

这是一个完整的、结构化的提示词，包含：
- 任务背景和目标
- 漏洞详细信息
- 代理配置和执行结果
- 需要分析的具体问题
- 期望的输出格式

### 2. 轨迹摘要
**文件**: `secb分析文档/trajectory_summary.txt`

自动生成的轨迹摘要，包含：
- 基本统计信息
- 关键步骤列表
- PoC 版本历史
- 测试结果
- 迭代模式分析
- 成功指标

### 3. 完整轨迹文件
**路径**: `trajectories/grinner/secb_poc__deepseek/deepseek-chat__t-0.00__p-0.95__c-1.50___secb_poc_eval/njs.cve-2022-32414/njs.cve-2022-32414.traj`

JSON 格式的完整执行轨迹，包含每一步的详细信息。

### 4. 分析脚本
**文件**: `secb分析文档/analyze_trajectory.py`

Python 脚本，用于从轨迹中提取关键信息。

## 🚀 使用方法

### 方法 1：直接使用（推荐）

**适合**: 与 Claude、GPT-4 等大模型对话

1. 打开 `分析提示词_轨迹分析.md`
2. 复制全部内容
3. 在新的对话中粘贴给 AI
4. 附上 `trajectory_summary.txt` 的内容（关键部分）
5. 如果 AI 需要更多细节，提供完整的 `.traj` 文件

**示例对话**：
```
User: [粘贴 分析提示词_轨迹分析.md 的内容]

User: 这是轨迹摘要：
[粘贴 trajectory_summary.txt 的关键部分]

User: 如果你需要查看完整轨迹的某些步骤，请告诉我步骤编号，我会提供详细信息。

AI: [开始分析...]
```

### 方法 2：提供完整文件

**适合**: 支持文件上传的 AI（如 Claude Code、Cursor 等）

1. 上传以下文件：
   - `分析提示词_轨迹分析.md`
   - `trajectory_summary.txt`
   - `njs.cve-2022-32414.traj` （如果支持大文件）

2. 直接询问：
   ```
   请根据提供的提示词和轨迹文件，进行深入分析。
   ```

### 方法 3：编程分析

**适合**: 需要自动化分析或处理大量轨迹

使用提供的 `analyze_trajectory.py` 脚本：

```bash
# 分析特定轨迹
python secb分析文档/analyze_trajectory.py path/to/trajectory.traj

# 或使用默认路径
python secb分析文档/analyze_trajectory.py
```

修改脚本添加自定义分析逻辑。

## 📋 推荐的分析流程

### 第一轮：快速概览
1. 提供提示词 + 摘要
2. 让 AI 给出初步分析和关键发现

### 第二轮：深入分析
1. 根据 AI 的问题，提供特定步骤的详细信息
2. 可以使用以下命令提取特定步骤：
   ```python
   import json
   with open('path/to/trajectory.traj', 'r') as f:
       traj = json.load(f)

   # 查看特定步骤
   step_num = 68  # PoC 创建步骤
   step = traj['trajectory'][step_num]
   print(f"Step {step_num}:")
   print(f"Action: {step['action']}")
   print(f"Thought: {step['thought']}")
   print(f"Observation: {step['observation'][:500]}")
   ```

### 第三轮：验证和改进
1. 根据分析结果，讨论改进方案
2. 设计新的实验或修改方法

## 🎯 分析重点

提醒 AI 重点关注：

### 技术层面
- [ ] 代理是否正确理解了漏洞的触发条件？
- [ ] 是否遗漏了关键的代码路径或数据流？
- [ ] PoC 的设计思路是否正确？

### 方法论层面
- [ ] 探索策略是否高效？
- [ ] 迭代过程是否有假设和验证？
- [ ] 是否陷入了某种思维定式？

### 工具层面
- [ ] 现有工具是否足够？
- [ ] 上下文窗口管理是否合理？
- [ ] 是否需要新的调试工具？

## 📊 期望的输出

根据提示词中的格式要求，AI 应该提供：

1. **执行摘要**：核心发现和失败原因
2. **详细分析**：5个维度的深入分析
3. **根本原因总结**：技术、方法论、工具三个层面
4. **改进建议**：短期、中期、长期
5. **具体行动方案**：针对此 CVE 和 SWE-agent 方法

## 💡 提示

1. **分阶段进行**：不要一次性提供所有信息，让 AI 主动提问
2. **保存对话**：分析结果可能很长，建议保存为文档
3. **迭代改进**：基于第一次分析，可以进行更深入的第二次分析
4. **交叉验证**：可以让不同的 AI 分析，对比结果

## 🔍 常见问题

### Q: 轨迹文件太大怎么办？
A:
1. 先提供摘要
2. AI 需要时再提供特定步骤
3. 使用脚本提取关键部分

### Q: 如何提取特定步骤的详细信息？
A: 使用以下代码：
```python
import json
with open('trajectory.traj', 'r') as f:
    traj = json.load(f)

# 提取步骤 N 的完整信息
step_n = traj['trajectory'][N]
print(json.dumps(step_n, indent=2, ensure_ascii=False))
```

### Q: AI 的分析不够深入怎么办？
A:
1. 提供更具体的问题
2. 引导 AI 关注特定的步骤或代码
3. 要求 AI 给出具体的代码示例或改进方案

## 📝 记录建议

建议创建一个分析记录文档，记录：
- 使用的 AI 模型
- 提供的信息
- AI 的关键发现
- 采纳的改进建议
- 后续实验结果

---

**开始分析吧！祝你找到改进 SWE-agent 的关键洞察！** 🎉
